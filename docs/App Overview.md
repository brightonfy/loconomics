# App Overview
Loconomics is a hybrid application built with HTML, CSS and JavaScript with a single codebase. It uses [Phonegap](http://phonegap.com/) to export the app to iOS and Android.

## Preprocessors
### CSS 
[Stylus](http://stylus-lang.com)

### JS 
[Browserify](http://browserify.org/)

### HTML 
[Bliss](html)

## Main libraries
[jQuery-2](https://jquery.com)

[Bootstrap-3](http://getbootstrap.com)

[Knockoutjs-3.3](http://knockoutjs.com)

[Polyfills](https://www.npmjs.com/package/js-polyfills) for ES5 and ES6-Promise

[Momentjs](http://momentjs.com/)

[Nodejs](https://nodejs.org/en/) to assist in front-end development

[Grunt](http://gruntjs.com/) as a tasks runner.

- Tutorial for knockout: http://knockoutjs.com


## File Organization
### /app (all app code)
  - /source: source code of the app and templates of configuration files
    - /html/activities: HTML source code. Each file needs to have a matching /js/activities file and optionally /css/activities.   
    - /css/activities: CSS code for matching HTML files. Each file needs to be included in app/source/css/app.styl.   
    - /js/activities: JS code for matching HTML files. Each file needs to be included in app/source/js/app.activities.js.   
    - /js/models: JS code that defines the data from the rest api as javascript objects. Referenced in both JS activities and JS AppModels.   
    - /js/appmodel: JS code for matching JS models that includes actions for that model (update, delete, cancel a booking, etc.) Each file needs to included in app/source/js/appmodel/appmodel.js
  - /build: automatic content, generated by the build process from source
  - /phonegap: automatic content, generated by the build process targetting Phonegap.
  - /build/latest.zip: It's a compressed bundled of the /phonegap content, ready to use in the PhoneGap Build service, used to compile the project for iOS and Android in the cloud (file ignored by git).
  - /node_modules: automatic content, managed by npm
  - /grunt: javascript files that define automated tasks using the Grunt task runner.
  - /trials: some testing files for things being developed, to try in a isolated context, temporary content.
  - /vendor: third party modules that are not at npm, or needed some custom build, or forked third party modules.
  - /package.js: NodeJS package definition file, keeps modules dependencies (npm) and some set-up variables.
  - /Gruntfile.js: file required by the Grunt task runner on the project root folder; more code is organized in the /grunt folder to don't have a fat Gruntfile.js file.
  
### /web (all server-side and API files)
- /_DBUpdate: MS SQL files of any changes to the database to ensure the dev, test and live databases get updated accordingly.
  - /api/v1: CSHTML files that communicate with the server and retrieve API data
    - /me: Information about a user requesting information about themselves, mostly private  
    - /user: Information about a user requesting information about another user, mostly public  
  - /App_Code/LcPricing: C# files that implements...
  - /App_Code/LcRest: C# files that implements the schemes for specific objects in the REST API, and static methods/queries/updates for database operations
  - /en-US/EmailCommunications: CSTHML files for all e-mail communcations sent to users
    - /Admin: Communications to users their account (welcome, password resets, etc.) 
      - /Internal: Communications sent to employees about important user actions (background check/license verification requests)
    - /Booking: Communications to users about bookings
      - /BookNow: All communications for BookNow bookings (from a service professional's website)
      - /Marketplace: All communications for Marketplace bookings (from the Loconomic's website/app)
      - /ServiceProfessionalBooking: All communications for bookings made by the service professional 



**PhoneGap Build** cloud service is used to create the intallation packages for iOS and Android.

To perform that task in your own computer, you need the SDKs of each platform:
- Apple XCode installed to create the iOS app; run the command:

  > phonegap build ios
  
- Android SDKs installed to create the Android app; run the command:

  > phonegap build android
  
Remember that the Phonegap plugins must be installed previously in order to be included in the local build.
It's done by placing you in the /app/phonegap directory from the command line/terminal and running something like:

> phonegap plugin add https://git-wip-us.apache.org/repos/asf/cordova-plugin-inappbrowser.git

The file /app/source/cordova-config.js.xml has a list of all the plugins in use (look at the *gap:plugin* elements),
this config is used by the PhoneGap Build service to automatically install them. The version in use is there too, but not
git URL, the package name can be used to locate it at [npm](https://www.npmjs.com/) and found the project git URL there.

### Important links to bookmark
**Test API:** http://dev.loconomics.com/tests/testrest (request access from @iagoSRL or @dani0198)

**Test Email Communications:** http://dev.loconomics.com/tests/testmessaging (request access from @iagoSRL or @dani0198)

**Test Any Page (for testing db changes):** http://dev.loconomics.com/tests/TestAny 

### Adding new pages to the app
**Step 1: Is there an existing endpoint/call/method already in the REST API for the data you need (another page using it)?**
- If no, send a request to @iagoSRL or @dani0198 explaining what's needed
- If yes, process to Step 2. 

**Step 2: create new files for front-end code**
- Find, copy and rename an example .html file from app/source/html/activities.
- Optional: Find, copy and rename an example .css file from app/source/css/activities & add file name to app/source/css/app.styl.
- Find, copy and rename an example .js file from app/source/js/activities & add file name to app/source/js/app.activities.js.

**Step 3: Edit your new html, css, js /activity files**
- Change data-activity name to new name. Review and revise .js file to reference the appopriate /models and /appmodel files and functions. 
- Change data-activity name to new name. Review and revise .html & .css files to have front end appearance you want referencing the css file of the same name. 
- Change references the appopriate js functions in html.

**Step 4: Test new page:**
- http://localhost:8811/app.html#!/newActivity
- Test any data you're using by placing console.log(data) in the .js file and reviewing using the browser's developer console
