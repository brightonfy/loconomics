/** Availability: Weekly Schedule section setup
**/
var $ = require('jquery');
var availabilityCalendar = require('LC/availabilityCalendar');

exports.on = function () {

  var workHoursList = availabilityCalendar.WorkHours.enableAll();

  $.each(workHoursList, function (i, v) {
    var workhours = this;

    // Setuping the WorkHours calendar data save when the form is submitted
    var form = workhours.$el.closest('form.ajax, fieldset.ajax');
    var field = form.find('[name=workhours]');
    if (field.length === 0)
      field = $('<input type="hidden" name="workhours" />').appendTo(form);
    form.on('presubmit', function () {
      field.val(JSON.stringify(workhours.data));
    });

    // Disabling calendar on field alltime
    form.find('[name=alltime]').on('change', function () {
      var $t = $(this),
        cl = workhours.classes.disabled;
      if (cl)
        workhours.$el.toggleClass(cl, $t.prop('checked'));
    });

  });
};
