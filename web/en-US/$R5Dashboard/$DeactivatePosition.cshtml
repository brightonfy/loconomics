@using WebMatrix.Data;
@{
    LcHelpers.ProviderPage();
    var u = LcData.UserInfo.GetUserRow();
    var positionID = Request["PositionID"].AsInt();

    if (positionID > 0) {
        using (var db = Database.Open("sqlloco")) {
            // It just update StatusID to 3 'private profile, manual activation'
            db.Execute("UPDATE UserProfilePositions SET StatusID = 3 WHERE UserID = @0 AND PositionID = @1", u.UserID, positionID);
        }
        if (Request.IsAjaxRequest()) {
            LcHelpers.ReturnJsonResult(101, null);
        }
    } else {
        if (Request.IsAjaxRequest()) {
            LcHelpers.ReturnJsonResult(103, new { Message = "We're sorry, we're unable to remove your profile.  Please contact us for help." });
        }
    }
    if (!Request.IsAjaxRequest()) {
        Response.Redirect(LcHelpers.GetRedirectURLFromReferrer("/R5Dashboard"));
    }
}
