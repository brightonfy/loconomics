@using WebMatrix.Data;
@{
    LcMessaging.SecureTemplate();
    
    Layout = LcUrl.RenderLangPath + "_EmailLayout.cshtml";
    Page.Title = "Loconomics.com - Recommendation";
    
    var customerID = Request["CustomerUserID"].AsInt();
    var customer = LcData.UserInfo.GetUserRow(customerID);
    var providerID = Request["ProviderUserID"].AsInt();
    var provider = LcData.UserInfo.GetUserRow(providerID);
    var position = LcData.UserInfo.GetUserPos(providerID, Request["PositionID"].AsInt());
    
    // Data for the EmailLayout:
    PageData["messageTitle"] = "Recommendation";
    // Create URL:
    PageData["viewOnSiteUrl"] = LcUrl.SiteUrl + LcData.UserInfo.GetUserPublicURL(providerID);
}
<div>
    Your friend @customer.FirstName @customer.LastName recommends you book @LcHelpers.GetUserDisplayName(provider)
    as a @position.PositionSingular at <a href="@LcUrl.LangUrl">Loconomics.com</a>
    <a href="@PageData["viewOnSiteUrl"]">View @provider.FirstName full profile</a>

    @RenderPage(LcUrl.RenderLangPath + "Email/$EmailUserInfoWidget.cshtml", new Dictionary<string, object>{ 
        {"AddContainerStyle", LcEmailTemplateHelper.StyleMessageSection()},        
        {"Data", provider},
        {"DataPrefix", ""},
        {"Size", "medium"},
        {"UserType", "provider"},
        {"WithContactData", false},
        {"WithGoogleMap", false}
    })
</div>