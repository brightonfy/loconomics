@{
    var p = PageData["providerrow"];
    var c = PageData["customerrow"];
    //var customerid = c.UserID;
    
    // Classes for differents calendar availability states
    var stateClasses = new List<string>(){"free", "busy", "tentative", "unavailable"};
    Random r = new Random();
}
@helper printOptionsHours(){
    var firstHour = new TimeSpan(9, 0, 0);
    var lastHour = new TimeSpan(18, 30, 0);
    var interval = new TimeSpan(0, 30, 0);
    for (var hour = firstHour; hour <= lastHour; hour += interval)
    {
        <option value="@hour.ToString("c")">@((new DateTime(hour.Ticks)).ToShortTimeString())</option>
    }
}

<p class="info">
    Please review your provider’s availability calendar and choose a location, preferred time for services to be peformed and up to two alternate times.  Being flexible helps the two of you get an accurate time booked quickly.  
</p>
<form action="#" method="post" class="schedule" id="booking-schedule">
    <input type="hidden" name="providerid" value="@p.UserID"/>
    <fieldset class="availability availability-calendar box">
        <legend>@(p.FirstName)'s availability:</legend>
        <div class="calendar">
            <ol class="days">
                <li><h5>S</h5></li><li><h5>M</h5></li><li><h5>T</h5></li><li><h5>W</h5></li><li><h5>T</h5></li><li><h5>F</h5></li><li><h5>S</h5></li>
            </ol>
            <ol class="hours">
                @for(var h = 7; h < 23; h++){
                <li><h5>@((new DateTime(2000, 1, 1, h, 0, 0)).ToString("ht"))</h5></li>
                }
            </ol>
            <ol class="datetimes">
                @for(var h = 7; h < 23; h++){
                 for(var b = 0; b < 2; b++){
                    var half = b == 0 ? "" : "half ";
                for(var d = 0; d < 7; d++)
                {<li class="@half@stateClasses[r.Next(0, 4)]"></li>}
                }}
            </ol>
        </div>
        <ul class="calendar-legend">
            <li class="free"><span class="color">Green</span>Free</li>
            <li class="busy"><span class="color">Purple</span>Busy</li>
            <li class="tentative"><span class="color">Yellow</span>Tentative</li>
            <li class="unavailable"><span class="color">White</span>Unavailable</li>
        </ul>
    </fieldset>
    <fieldset class="location box">
        <legend>Location where services are to be performed:</legend>
        <ul>
            <li class="street-address-line-1">
                <label>Street address line 1:<input type="text" name="street-address-line-1"/></label>
            </li>
            <li class="street-address-line-2">
                <label>Street address line 2:<input type="text" name="street-address-line-2"/></label>
            </li>
            <li class="city">
                <label>City:<input type="text" name="city"/></label>
            </li>
            <!-- Collapsed next elements code to avoid white spaces that create excesive width on IE -->
            <li class="state"><label>State:<select name="state">
                        <option value="ca">California</option>
                    </select></label></li>
            <li class="zip">
                <label>Zip Code:<input type="text" name="zip"/></label>
            </li>
            <li class="save-to-my-locations">
                <label class="save"><input type="checkbox" name="save"/>Save</label>
                <label>to my locations as:<input type="text" name="save-location-as"/></label>
            </li>
        </ul>
    </fieldset>
    <fieldset class="select-schedule">
        <fieldset class="preferred-option select-date-time box">
            <legend>My preferred option:</legend>
            <ul>
                <li class="date">
                    <label>Date:<input class="date date-pick" type="text" name="preferred-date"/></label>
                </li>
                <li class="start-time">
                    <label>Start time:<select name="preferred-start-time">@printOptionsHours()</select></label>
                </li>
                <li class="end-time">
                    <label>End time:<select name="preferred-end-time">@printOptionsHours()</select></label>
                </li>
            </ul>
        </fieldset>
        <fieldset class="alternative-option-1 select-date-time box">
            <legend>Second best option:</legend>
            <ul>
                <li class="date">
                    <label>Date:<input class="date date-pick" type="text" name="alternative-1-date"/></label>
                </li>
                <li class="start-time">
                    <label>Start time:<select name="alternative-1-start-time">@printOptionsHours()</select></label>
                </li>
                <li class="end-time">
                    <label>End time:<select name="alternative-1-end-time">@printOptionsHours()</select></label>
                </li>
            </ul>
        </fieldset>
        <fieldset class="alternative-option-2 select-date-time box">
            <legend>Third best option:</legend>
            <ul>
                <li class="date">
                    <label>Date:<input class="date date-pick" type="text" name="alternative-21-date"/></label>
                </li>
                <li class="start-time">
                    <label>Start time:<select name="alternative-2-start-time">@printOptionsHours()</select></label>
                </li>
                <li class="end-time">
                    <label>End time:<select name="alternative-2-end-time">@printOptionsHours()</select></label>
                </li>
            </ul>
        </fieldset>
        <fieldset class="recurring">
            <label><input type="checkbox" name="recurring"/>Make this appointment recurring</label>
        </fieldset>
    </fieldset>
    <fieldset class="actions">
        <button class="proceed-to-payment next">Provide payment</button>
    </fieldset>
</form>
