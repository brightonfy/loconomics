@*
    This page is called to populate a JSON object with the Pricing Estimation Vars for a given Provider, Position and Pricing Type

    INPUT:
        positionID
        pricingTypeID
*@
@{
    var positionID = Request["PositionID"].AsInt();
    var pricingTypeID = Request["PricingTypeID"].AsInt();

    var db = Database.Open("sqlloco");
    var sql = @"SELECT sev.EstimateVarID, ev.ProviderDescription, ev.GroupID, ev.Value, ev.ProviderTag, ev.UserTag
                FROM dbo.serviceestimatevars sev
                JOIN dbo.estimatevar ev ON (ev.EstimateVarID=sev.EstimateVarID)
                WHERE sev.PositionID = @0 and sev.PricingTypeID = @1";
    var data = db.Query(sql, positionID, pricingTypeID);

    CommonHelpers.ReturnJsonResult(0, data);
}