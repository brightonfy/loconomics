@{
    var UserID = WebSecurity.CurrentUserId;
    var db = Database.Open("sqlloco");
    var query = @"SELECT m.body, tm.fromID, u.FirstName, u.LastName
                FROM Messages m
                JOIN ThreadMessage tm ON (m.messageID = tm.messageID)
                JOIN Users u ON (u.UserID = @0)
                WHERE tm.toID = @0";
    var messages = db.Query(query,UserID);
    var grid = new WebGrid(messages, ajaxUpdateContainerId: "inbox_grid");                    
}
@grid.GetHtml(columns: grid.Columns(    
                                    grid.Column("FirstName", header:"From"),
                                    grid.Column("body", header:"Message Body")
                                    )
            )
