@functions {

    /* Get a data row with the User Public Profile information from the database
    */
    public static object GetProviderProfileRow(int userId){
        var db = Database.Open("sqlloco");
        var profilesql = @"SELECT a.UserID, FirstName,LastName,PublicBio,Photo,PreferredLanguageID,PreferredCountryID,ADD_Details,Email,rs.Rating1,rs.Rating2,rs.Rating3,rs.Rating4 
                        FROM users a 
                        LEFT JOIN dbo.userprofilepositionadditional b ON (a.userid = b.userid)
                        JOIN dbo.userprofile e ON  (a.userid = e.userid)
                        LEFT JOIN dbo.UserReviewScores rs ON (a.userid = rs.UserID)                     
                        WHERE a.userid = @0";

        return db.QuerySingle(profilesql, userId);
    }
    
    public static object GetProfilePositionRow(int userId, int positionId){
        var db = Database.Open("sqlloco");
        var positionsql ="select distinct  d.ServiceAttributeCategoryID,d.ServiceAttributeCategory from dbo.userprofilepositions a join dbo.userprofileserviceattributes b on a.UserID = b.UserID and a.PositionID = b.PositionID join dbo.servicecategoryattributemapping c on b.SCAMID = c.SCAMID join dbo.serviceattributecategory d on c.ServiceAttributeCategoryID = d.ServiceAttributeCategoryID where a.UserID = @0 and b.PositionID = @1 ";
        // TODO: (un-)used SQL sentence on body of "Profile/_Overview.cshtml" (come from the old ProviderProfile.cshtml file):
        var positionattributesql ="select distinct d.ServiceAttributeCategoryID,d.ServiceAttributeCategory,e.ServiceAttributeID,e.Name from dbo.userprofilepositions a join dbo.userprofileserviceattributes b on a.UserID = b.UserID and a.PositionID = b.PositionID join dbo.servicecategoryattributemapping c on b.SCAMID = c.SCAMID join dbo.serviceattributecategory d on c.ServiceAttributeCategoryID = d.ServiceAttributeCategoryID join dbo.serviceattribute e on c.ServiceAttributeID = e.ServiceAttributeID where a.UserID = @0 and b.PositionID = @1 and d.ServiceAttributeCategoryID = @2 and d.LanguageID = 1 and d.CountryID = 1";
        
        return db.Query(positionsql, userId, positionId);
    }
}